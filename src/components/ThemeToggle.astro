---

---

<theme-toggle>
    <button id="theme-btn" class="toggle-track" aria-label="Toggle theme">
        <div class="toggle-thumb">
            <span class="icon sun">‚òÄÔ∏è</span>
            <span class="icon moon">üíª</span>
        </div>
        <div class="labels">
            <span class="label-day">ÂÄºÁè≠‰∏≠</span>
            <span class="label-night">ÂØ´Êâ£‰∏≠</span>
        </div>
    </button>
</theme-toggle>

<script>
    class ThemeToggle extends HTMLElement {
        constructor() {
            super();
            const button = this.querySelector("button");

            // 1. Init state based on localStorage or system preference
            const theme = (() => {
                if (
                    typeof localStorage !== "undefined" &&
                    localStorage.getItem("theme")
                ) {
                    return localStorage.getItem("theme");
                }
                if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                    return "dark";
                }
                return "light";
            })();

            if (theme === "dark") {
                document.documentElement.setAttribute("data-theme", "dark");
            } else {
                document.documentElement.removeAttribute("data-theme");
            }

            // 2. Button Click Handler
            button?.addEventListener("click", () => {
                const isDark =
                    document.documentElement.getAttribute("data-theme") ===
                    "dark";
                const newTheme = isDark ? "light" : "dark";

                if (newTheme === "dark") {
                    document.documentElement.setAttribute("data-theme", "dark");
                } else {
                    document.documentElement.removeAttribute("data-theme");
                }

                localStorage.setItem("theme", newTheme);
            });
        }
    }

    customElements.define("theme-toggle", ThemeToggle);
</script>

<style>
    .toggle-track {
        background: var(--color-border);
        border: none;
        border-radius: 20px;
        width: 140px;
        height: 36px;
        position: relative;
        cursor: pointer;
        display: flex;
        align-items: center;
        padding: 4px;
        overflow: hidden;
        transition: background-color 0.3s;
    }

    .toggle-thumb {
        position: absolute;
        left: 4px;
        width: 28px;
        height: 28px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 2;
    }

    .icon {
        font-size: 14px;
        line-height: 1;
    }

    .moon {
        display: none;
    }

    /* Dark Mode State */
    :global([data-theme="dark"]) .toggle-thumb {
        transform: translateX(
            104px
        ); /* width 140 - padding 4 - thumb 28 - right padding 4 = 104 */
        background: var(--color-secondary);
    }
    :global([data-theme="dark"]) .sun {
        display: none;
    }
    :global([data-theme="dark"]) .moon {
        display: block;
    }

    .labels {
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 0 10px;
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        color: var(--color-text-light);
        z-index: 1;
        pointer-events: none; /* Let clicks pass through to button */
    }

    .label-day {
        opacity: 1;
        transition: opacity 0.3s;
    }
    .label-night {
        opacity: 0.5;
        transition: opacity 0.3s;
    }

    :global([data-theme="dark"]) .label-day {
        opacity: 0.5;
    }
    :global([data-theme="dark"]) .label-night {
        opacity: 1;
        color: var(--color-white);
    }
</style>
