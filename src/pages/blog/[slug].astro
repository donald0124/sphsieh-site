---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
    const posts = await getCollection("posts");
    return posts.map((entry) => ({
        params: { slug: entry.slug },
        props: { entry },
    }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout title={entry.data.title}>
    <nav
        class="navbar"
        style="position: sticky; top: 0; background: white; z-index: 1000; box-shadow: 0 2px 4px rgba(0,0,0,0.05);"
    >
        <div
            class="container nav-container"
            style="padding-top: 0; padding-bottom: 0; height: 70px;"
        >
            <a href="/" class="nav-logo"
                >Po Hsieh<span style="color:var(--color-secondary);">.</span></a
            >
            <div style="margin-left: auto;">
                <a
                    href="/blog"
                    class="nav-link"
                    style="text-decoration: none; font-weight: 500;"
                    >‚Üê Back to Blog</a
                >
            </div>
        </div>
    </nav>
    <article
        class="container post-container"
        style="padding-top: 40px; padding-bottom: 80px;"
    >
        <header class="post-header">
            <h1 class="post-h1">{entry.data.title}</h1>
            <div class="post-meta">
                <time class="post-time"
                    >{entry.data.publishedDate.toLocaleDateString()}</time
                >
            </div>
        </header>
        <div class="prose">
            <Content />
        </div>
    </article>
</Layout>

<style>
    .post-container {
        max-width: 720px;
        margin: 0 auto;
        padding-left: 1rem;
        padding-right: 1rem;
    }
    .post-header {
        text-align: center;
        margin-bottom: 3rem;
        border-bottom: 1px solid #e2e8f0;
        padding-bottom: 2rem;
    }
    .post-h1 {
        font-size: 2.5rem;
        color: var(--color-primary);
        line-height: 1.2;
        margin-bottom: 1rem;
    }
    .post-time {
        color: var(--color-text-light);
        font-size: 0.95rem;
    }
    .prose {
        line-height: 1.8;
        color: var(--color-text);
        font-size: 1.125rem;
    }
    /* Add basic typography for markdown content */
    .prose :global(h2) {
        font-size: 1.8rem;
        margin-top: 2.5rem;
        margin-bottom: 1rem;
        color: var(--color-primary);
        font-weight: 700;
        line-height: 1.3;
    }
    .prose :global(h3) {
        font-size: 1.4rem;
        margin-top: 2rem;
        margin-bottom: 0.75rem;
        color: var(--color-primary);
        font-weight: 600;
    }
    .prose :global(p) {
        margin-bottom: 1.5rem;
    }
    .prose :global(ul) {
        margin-bottom: 1.5rem;
        padding-left: 1.5rem;
        list-style-type: disc;
    }
    .prose :global(li) {
        margin-bottom: 0.5rem;
    }
    .prose :global(a) {
        color: var(--color-secondary);
        text-decoration: underline;
    }
    .prose :global(strong) {
        color: var(--color-primary);
        font-weight: 700;
    }
    .prose :global(blockquote) {
        border-left: 4px solid var(--color-secondary);
        padding-left: 1rem;
        color: var(--color-text-light);
        font-style: italic;
        margin-left: 0;
        margin-bottom: 1.5rem;
    }
    .prose :global(img) {
        max-width: 100%;
        height: auto;
        border-radius: var(--radius-card);
        margin: 2rem 0;
        box-shadow: var(--shadow-card);
    }

    .nav-logo {
        font-size: 1.5rem;
        font-weight: 900;
        color: var(--color-primary);
        text-decoration: none;
        display: flex;
        align-items: center;
    }
    .nav-container {
        display: flex;
        align-items: center;
    }
</style>
